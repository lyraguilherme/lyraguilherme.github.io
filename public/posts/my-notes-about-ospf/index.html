<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>My notes about OSPF | Guilherme Lyra</title>
<meta name="keywords" content="">
<meta name="description" content="Introduction
This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.

IMPORTANT: I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.

OSPFv2
OSPFv2 is documented under RFC 2328, which states the following:
OSPF routes IP packets based solely on the destination IP address found in the IP packet header.  IP packets are routed &ldquo;as is&rdquo; &ndash; they are not encapsulated in any further protocol headers as they transit the Autonomous System.  OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/my-notes-about-ospf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/my-notes-about-ospf/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/my-notes-about-ospf/">
  <meta property="og:site_name" content="Guilherme Lyra">
  <meta property="og:title" content="My notes about OSPF">
  <meta property="og:description" content="Introduction This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.
IMPORTANT: I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.
OSPFv2 OSPFv2 is documented under RFC 2328, which states the following:
OSPF routes IP packets based solely on the destination IP address found in the IP packet header. IP packets are routed “as is” – they are not encapsulated in any further protocol headers as they transit the Autonomous System. OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.">
  <meta property="og:locale" content="en-US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-22T14:07:09-03:00">
    <meta property="article:modified_time" content="2023-02-22T14:07:09-03:00">
    <meta property="og:image" content="http://localhost:1313/my-notes-about-ospf/ospf_cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/my-notes-about-ospf/ospf_cover.png">
<meta name="twitter:title" content="My notes about OSPF">
<meta name="twitter:description" content="Introduction
This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.

IMPORTANT: I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.

OSPFv2
OSPFv2 is documented under RFC 2328, which states the following:
OSPF routes IP packets based solely on the destination IP address found in the IP packet header.  IP packets are routed &ldquo;as is&rdquo; &ndash; they are not encapsulated in any further protocol headers as they transit the Autonomous System.  OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "My notes about OSPF",
      "item": "http://localhost:1313/posts/my-notes-about-ospf/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "My notes about OSPF",
  "name": "My notes about OSPF",
  "description": "Introduction This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.\nIMPORTANT: I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.\nOSPFv2 OSPFv2 is documented under RFC 2328, which states the following:\nOSPF routes IP packets based solely on the destination IP address found in the IP packet header. IP packets are routed \u0026ldquo;as is\u0026rdquo; \u0026ndash; they are not encapsulated in any further protocol headers as they transit the Autonomous System. OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.\n",
  "keywords": [
    
  ],
  "articleBody": "Introduction This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.\nIMPORTANT: I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.\nOSPFv2 OSPFv2 is documented under RFC 2328, which states the following:\nOSPF routes IP packets based solely on the destination IP address found in the IP packet header. IP packets are routed “as is” – they are not encapsulated in any further protocol headers as they transit the Autonomous System. OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.\nThis period of convergence is short and involves a minimum of routing traffic.\nIn a link-state routing protocol, each router maintains a database describing the Autonomous System’s topology. This database is referred to as the link-state database. Each participating router has an identical database. Each individual piece of this database is a particular router’s local state (e.g., the router’s usable interfaces and reachable neighbors).\nThe router distributes its local state throughout the Autonomous System by flooding.\nOSPFv2 Packet Header OSPFv3 OSPFv3 is documented under RFC 5340\nAbstract:\nThis document describes the modifications to OSPF to support version 6 of the Internet Protocol (IPv6). The fundamental mechanisms of OSPF (flooding, Designated Router (DR) election, area support, Short Path First (SPF) calculations, etc.) remain unchanged. However, some changes have been necessary, either due to changes in protocol semantics between IPv4 and IPv6, or simply to handle the increased address size of IPv6. These modifications will necessitate incrementing the protocol version from version 2 to version 3. OSPF for IPv6 is also referred to as OSPF version 3 (OSPFv3).\nChanges between OSPF for IPv4, OSPF Version 2, and OSPF for IPv6 as described herein include the following. Addressing semantics have been removed from OSPF packets and the basic Link State Advertisements (LSAs). New LSAs have been created to carry IPv6 addresses and prefixes. OSPF now runs on a per-link basis rather than on a per-IP-subnet basis. Flooding scope for LSAs has been generalized. Authentication has been removed from the OSPF protocol and instead relies on IPv6’s Authentication Header and Encapsulating Security Payload (ESP).\nEven with larger IPv6 addresses, most packets in OSPF for IPv6 are almost as compact as those in OSPF for IPv4. Most fields and packet- size limitations present in OSPF for IPv4 have been relaxed. In addition, option handling has been made more flexible.\nAll of OSPF for IPv4’s optional capabilities, including demand circuit support and Not-So-Stubby Areas (NSSAs), are also supported in OSPF for IPv6.\nOSPFv3 Packet Header Multicast Groups OSPFv2 Multicast groups Multicast Group Description 224.0.0.5 All OSPF Routers 224.0.0.6 All DR Routers OSPFv3 Multicast groups Multicast Group Description FF02::5 OSPFv3 Routers FF02::6 OSPFv3 Designated Routers Timers Interval Broadcast Non-Broadcast Point-to-Point Point-to-Multipoint Point-to-Multipoint Non-Broadcast Hello 10 30 10 30 30 Dead 40 120 40 90 120 Wait 40 90 Retransmit 5 5 5 5 5 OSPFv2 LSA Types LSA Type 1 – Router LSA Route Type: Intra-Area CLI Command:\nshow ip ospf database router Description: Each router within an area floods a Type 1 Router LSA to other routers in the same area. This LSA describes all of the router’s interfaces, neighbor relationships, and metrics. LSA Type 2 – Network LSA Route Type: Intra-Area CLI Command:\nshow ip ospf database network Description: Generated by the Designated Router (DR) on multi-access networks (e.g., Ethernet). Represents the multi-access network and all attached routers as a pseudonode (virtual router). Lists all routers connected to the network segment, including the DR itself. Like Type 1 LSAs, Type 2 LSAs are flooded only within the originating area. LSA Type 3 – Network Summary LSA Route Type: Inter-Area CLI Command:\nshow ip ospf database summary Description: Originated by ABRs. Advertises destinations outside the local area into the area. Used by ABRs to inform internal routers about reachable destinations in other areas. ABRs also advertise routes from their own areas into the backbone (Area 0) using Type 3 LSAs. Can also be used to advertise default routes internal to the OSPF autonomous system. LSA Type 4 – ASBR Summary LSA Route Type: Inter-Area CLI Commands:\nshow ip ospf database asbr-summary\nshow ip ospf border-routers Description: Also originated by ABRs. Similar to Type 3 LSAs but specifically advertises routes to ASBRs. The destination is always a host address representing the ASBR router itself. LSA Type 5 – External LSA Route Type: External Routes (E1/E2) CLI Commands:\nshow ip ospf database external\nshow ip ospf border-routers Description: Originated by ASBRs. Advertises destinations external to the OSPF autonomous system (e.g., routes from BGP, static). Can also advertise default routes from outside the OSPF domain. Flooded throughout the entire OSPF domain. LSA Type 7 – NSSA External LSA Route Type: External Routes (N1/N2) CLI Commands:\nshow ip ospf database external\nshow ip ospf border-routers Description: Originated by ASBRs within Not-So-Stubby Areas (NSSA). Similar to Type 5 LSAs but scoped only within the originating NSSA. Not flooded beyond the NSSA; may be translated to Type 5 by the ABR for propagation beyond the NSSA. OSPF Options Down Bit The down bit helps prevent routing loops between MP-BGP and OSPF when LSA Type 3 are used, but not when External Routes are announced. With LSA Type 5 and Type 7, there is a new field checked to avoid loops is called the Tag field. When a PE redistributes a route from MP-BGP into OSPF as LSA Type 5 or LSA Type 7, it adds a Tag to the route (tag 3989725929 by default). So if another PE receives an LSA Type 5 or LSA Type 7 with this tag, it doesn’t redistribute it back into MP-BGP. The default Tag value of 3989725929 can be changed to any other value (redistribute bgp 65001 subnets tag 100). N Bit This bit is used in hello packets for OSPF NSSA routers. When the N-bit is not supported, the routers won’t become neighbors. P Bit The P-bit (P stands for propagate) is set in the Options field of an LSA type 7. P-bit tells the ABR if the LSA type 7 should be translated into a LSA type 5 or not. P-bit is automatically set by default for all prefixes that are redistributed by the ASBR and are flooded within that area only. Can be disabled with nssa-only keyword. The P-bit is not set only when the NSSA ASBR and NSSA ABR are the same router for the area. This P-bit is automatically set by the NSSA ABR (also the Forwarding Address (FA) is copied from Type 7 LSA). Note:\nIf a router is attached to another AS and is also an NSSA ABR, it may originate a both a Type 5 and a Type 7 LSA for the same network. The Type 5 LSA will be flooded to the backbone and the Type 7 will be flooded into the NSSA. If this is the case, the P-bit must be reset (P=0) in the Type 7 LSA so the Type 7 LSA isn’t again translated into a Type 5 LSA by another NSSA ABR. Routing Bit The routing bit is not a part of the LSA itself. Routing Bit is an internal maintenance bit used by IOS indicating that the route to the destination advertised by this LSA is valid. So when you see “Routing Bit Set on this LSA,” it means that the route to this destination is in the routing table. Demand Circuit Per RFC 1793, Extending OSPF to Support Demand Circuits, “OSPF Hellos and the refresh of OSPF routing information are suppressed on demand circuits, allowing the underlying data-link connections to be closed when not carrying application traffic.” This feature allows low-speed and pay-per-use links, such as analog dial and ISDN, to run OSPF without the need for periodic hellos and LSA flooding. Periodic hellos are only suppressed for point-to-point and point-to-multipoint OSPF network types. This feature is enabled with the interface-level command ip ospf demand-circuit and is negotiated as part of the neighbor adjacency establishment, thus only one OSPF router on the segment requires that the feature be enabled. If routers on the segment do not support it, it will just ignore the option in the HELLO packet, but OSPF neighbors will still be established. Flood Reduction Per RFC 2328, OSPF Version 2, “an LSA’s LS age is never incremented past the value MaxAge.\", so when the Link State Age reaches MaxAge, “the router must attempt to flush the LSA… by reflooding the MaxAge LSA just as if it was a newly originated LSA”. In Cisco’s IOS implementation of OSPF, the MaxAge value is 3600 seconds, or 60 minutes. To ensure that an LSA is not aged out, which means it will be flushed from the OSPF database, each LSA is reflooded after 30 minutes, regardless of whether the topology is stable or not. This periodic flooding behavior is commonly referred to as the “paranoid update.” The ip ospf flood-reduction feature stops unnecessary LSA flooding by setting the DoNotAge (DNA) bit in the LSA, removing the requirement for the periodic refresh. This needs to be enabled on links with OSPF neighbors attached, as on the other links, as there are no neighbors, no LSAs are sent anyways. Stub Router Feature Prevents a router from becoming a transit router (nontransit router). Nontransit routers only forward packets to and from locally attached subnets. max-metric router-lsa\nonly transit networks max-metric router-lsa include-stub transit networks + stub networks (ex: loopback) max-metric router-lsa on-startup announce-time max-metric router-lsa on-startup wait-for-bgp OSPF Graceful Shutdown Similar to using the shutdown command on an interface, there is also a shutdown command for OSPF. This allows you to gracefully stop the OSPF routing process without removing the configuration from your router. You can do this globally or on the interface level.\nIf you want to do a graceful shutdown globally, you have to use the shutdown command under the OSPF process. This will:\nDrop all neighbor adjacencies Flush all LSAs that the router originated by setting the age to 3600 seconds Send hello packets with the DR/BDR set to 0.0.0.0 and an empty neighbor list. This will trigger other OSPF routers to fall back to init state. Stop sending/receiving OSPF packets If you shut OSPF on the interface level with the ip ospf shutdown command, it will do this:\nDrop all neighbor adjacencies on the interface you selected Flood updated LSAs where all information (prefix, neighbors) from the selected interface is removed Send hello packets with the DR/BDR set to 0.0.0.0 and an empty neighbor list. This will trigger other OSPF router to fall back to init state Stop sending/receiving OSPF packets OSPF Filtering OSPF RIB Filtering distribute-list with ACL distribute-list with route-map Administrative Distance RIB filtering does not stop the flooding of LSAs within the area Inter Area Routes area X range 10.0.0.0 not-advertise Only effective when ABR is translating from Type 1 LSA to a Type 3 LSA (learn from INTRA Area and advertise INTER Area) area X filter-list prefix XXX in prevent routes from being advertised TO the specified area area X filter-list prefix XXX out prevent routes from being advertised FROM the specified area External Routes (LSA Type 5/7) Effective to filter when going between areas Has to be applied on the device that is doing the translation into Type 5 LSA\nsummary-address 10.0.0.0 255.255.255.0 not-advertise summary-address 10.0.0.0 255.255.255.0 nssa-only Inter-Area OSPF is Distance Vector (OSPF Loop Prevention) The content below is from an amazing post by Jeff Doyle, available on the link below, where Jeff gets into details about OSPF’s behavior with Intra-Area deployments.\nSource: https://www.networkworld.com/article/2348778/my-favorite-interview-question.html\nWhy does OSPF require all traffic between non-backbone areas to pass through a backbone area (area 0)?\nComparing three fundamental concepts of link state protocols, concepts that even most OSPF beginners understand, easily derives the answer to the above question.\nThe first concept:\nEvery link state router floods information about itself, its links, and its neighbors to every other router. From this flooded information each router builds an identical link state database. Each router then independently runs a shortest-path-first calculation on its database – a local calculation using distributed information – to derive a shortest-path tree. This tree is a sort of map of the shortest path to every other router.\nOne of the advantages of link state protocols is that the link state database provides a “view” of the entire network, preventing most routing loops. This is in contrast to distance vector protocols, in which route information is passed hop-by-hop through the network and a calculation is performed at each hop – a distributed calculation using local information. Each router along a route is dependent on the router before it to perform its calculations correctly and then correctly pass along the results. When a router advertises the prefixes it learns to its neighbors it’s basically saying, “I know how to reach these destinations.” And because each distance vector router knows only what its neighbors tell it, and has no “view” of the network beyond the neighbors, the protocol is vulnerable to loops.\nThe second concept:\nWhen link state domains grow large, the flooding and the resulting size of the link state database becomes a scaling problem. The problem is remedied by breaking the routing domain into areas: That first concept is modified so that flooding occurs only within the boundaries of an area, and the resulting link state database contains only information from the routers in the area. This, in turn, means that each router’s calculated shortest-path tree only describes the path to other routers within the area.\nThe third concept:\nOSPF areas are connected by one or more Area Border Routers (the other main link state protocol, IS-IS, connects areas somewhat differently) which maintain a separate link state database and calculate a separate shortest-path tree for each of their connected areas. So an ABR by definition is a member of two or more areas. It advertises the prefixes it learns in one area to its other areas by flooding Type 3 LSAs into the areas that basically say, “I know how to reach these destinations.” Wait a minute – what that last concept described is not link state, it’s distance vector. The routers in an area cannot “see” past the ABR, and rely on the ABR to correctly tell them what prefixes it can reach. The SPF calculation within an area derives a shortest-path tree that depicts all prefixes beyond the ABR as leaf subnets connected to the ABR at some specified cost.\nAnd that leads us to the answer to the question: Because inter-area OSPF is distance vector, it is vulnerable to routing loops. It avoids loops by mandating a loop-free inter-area topology, in which traffic from one area can only reach another area through area 0.\n",
  "wordCount" : "2494",
  "inLanguage": "en",
  "image":"http://localhost:1313/my-notes-about-ospf/ospf_cover.png","datePublished": "2023-02-22T14:07:09-03:00",
  "dateModified": "2023-02-22T14:07:09-03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/my-notes-about-ospf/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Guilherme Lyra",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Guilherme Lyra (Alt + H)">Guilherme Lyra</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/pt-br/" title="Português"
                            aria-label="Português">Pt-Br</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives/" title="All posts">
                    <span>All posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      My notes about OSPF
    </h1>
    <div class="post-meta"><span title='2023-02-22 14:07:09 -0300 -03'>February 22, 2023</span>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/my-notes-about-ospf/ospf_cover.png" alt="My notes about OSPF">
        <figcaption>My notes about OSPF</figcaption>
</figure><div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#ospfv2" aria-label="OSPFv2">OSPFv2</a><ul>
                        
                <li>
                    <a href="#ospfv2-packet-header" aria-label="OSPFv2 Packet Header">OSPFv2 Packet Header</a></li></ul>
                </li>
                <li>
                    <a href="#ospfv3" aria-label="OSPFv3">OSPFv3</a><ul>
                        
                <li>
                    <a href="#ospfv3-packet-header" aria-label="OSPFv3 Packet Header">OSPFv3 Packet Header</a></li></ul>
                </li>
                <li>
                    <a href="#multicast-groups" aria-label="Multicast Groups">Multicast Groups</a><ul>
                        
                <li>
                    <a href="#ospfv2-multicast-groups" aria-label="OSPFv2 Multicast groups">OSPFv2 Multicast groups</a></li>
                <li>
                    <a href="#ospfv3-multicast-groups" aria-label="OSPFv3 Multicast groups">OSPFv3 Multicast groups</a></li></ul>
                </li>
                <li>
                    <a href="#timers" aria-label="Timers">Timers</a></li>
                <li>
                    <a href="#ospfv2-lsa-types" aria-label="OSPFv2 LSA Types">OSPFv2 LSA Types</a><ul>
                        
                <li>
                    <a href="#lsa-type-1--router-lsa" aria-label="LSA Type 1 – Router LSA">LSA Type 1 – Router LSA</a></li>
                <li>
                    <a href="#lsa-type-2--network-lsa" aria-label="LSA Type 2 – Network LSA">LSA Type 2 – Network LSA</a></li>
                <li>
                    <a href="#lsa-type-3--network-summary-lsa" aria-label="LSA Type 3 – Network Summary LSA">LSA Type 3 – Network Summary LSA</a></li>
                <li>
                    <a href="#lsa-type-4--asbr-summary-lsa" aria-label="LSA Type 4 – ASBR Summary LSA">LSA Type 4 – ASBR Summary LSA</a></li>
                <li>
                    <a href="#lsa-type-5--external-lsa" aria-label="LSA Type 5 – External LSA">LSA Type 5 – External LSA</a></li>
                <li>
                    <a href="#lsa-type-7--nssa-external-lsa" aria-label="LSA Type 7 – NSSA External LSA">LSA Type 7 – NSSA External LSA</a></li></ul>
                </li>
                <li>
                    <a href="#ospf-options" aria-label="OSPF Options">OSPF Options</a><ul>
                        
                <li>
                    <a href="#down-bit" aria-label="Down Bit">Down Bit</a></li>
                <li>
                    <a href="#n-bit" aria-label="N Bit">N Bit</a></li>
                <li>
                    <a href="#p-bit" aria-label="P Bit">P Bit</a></li>
                <li>
                    <a href="#routing-bit" aria-label="Routing Bit">Routing Bit</a></li>
                <li>
                    <a href="#demand-circuit" aria-label="Demand Circuit">Demand Circuit</a></li>
                <li>
                    <a href="#flood-reduction" aria-label="Flood Reduction">Flood Reduction</a></li>
                <li>
                    <a href="#stub-router-feature" aria-label="Stub Router Feature">Stub Router Feature</a></li>
                <li>
                    <a href="#ospf-graceful-shutdown" aria-label="OSPF Graceful Shutdown">OSPF Graceful Shutdown</a></li></ul>
                </li>
                <li>
                    <a href="#ospf-filtering" aria-label="OSPF Filtering">OSPF Filtering</a><ul>
                        
                <li>
                    <a href="#ospf-rib-filtering" aria-label="OSPF RIB Filtering">OSPF RIB Filtering</a></li>
                <li>
                    <a href="#inter-area-routes" aria-label="Inter Area Routes">Inter Area Routes</a></li>
                <li>
                    <a href="#external-routes-lsa-type-57" aria-label="External Routes (LSA Type 5/7)">External Routes (LSA Type 5/7)</a></li></ul>
                </li>
                <li>
                    <a href="#inter-area-ospf-is-distance-vector-ospf-loop-prevention" aria-label="Inter-Area OSPF is Distance Vector (OSPF Loop Prevention)">Inter-Area OSPF is Distance Vector (OSPF Loop Prevention)</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>This post is a summary of OSPF that I compiled during my CCIE journey, gathering information from RFCs, books, Cisco documentation, blogs, and other sources.</p>
<blockquote>
<p><strong><em>IMPORTANT:</em></strong> I’m still in the process of converting this page from my original notes, so some information may be missing, and the formatting may not yet be fully refined.</p></blockquote>
<hr>
<h1 id="ospfv2">OSPFv2<a hidden class="anchor" aria-hidden="true" href="#ospfv2">#</a></h1>
<p>OSPFv2 is documented under <strong>RFC 2328</strong>, which states the following:</p>
<p>OSPF routes IP packets based solely on the destination IP address found in the IP packet header.  IP packets are routed &ldquo;as is&rdquo; &ndash; they are not encapsulated in any further protocol headers as they transit the Autonomous System.  OSPF is a dynamic routing protocol. It quickly detects topological changes in the AS (such as router interface failures) and calculates new loop-free routes after a period of convergence.</p>
<p>This period of convergence is short and involves a minimum of routing traffic.</p>
<p>In a link-state routing protocol, each router maintains a database describing the Autonomous System&rsquo;s topology.  This database is referred to as the link-state database. Each participating router has an identical database.  Each individual piece of this database is a particular router&rsquo;s local state (e.g., the router&rsquo;s usable interfaces and reachable neighbors).</p>
<p>The router distributes its local state throughout the Autonomous System by flooding.</p>
<h2 id="ospfv2-packet-header">OSPFv2 Packet Header<a hidden class="anchor" aria-hidden="true" href="#ospfv2-packet-header">#</a></h2>
<p><img alt="OSPFv2 Packet Header" loading="lazy" src="/my-notes-about-ospf/packet_header.png"></p>
<h1 id="ospfv3">OSPFv3<a hidden class="anchor" aria-hidden="true" href="#ospfv3">#</a></h1>
<p>OSPFv3 is documented under <strong>RFC 5340</strong></p>
<p>Abstract:</p>
<blockquote>
<p>This document describes the modifications to OSPF to support version
6 of the Internet Protocol (IPv6).  The fundamental mechanisms of
OSPF (flooding, Designated Router (DR) election, area support, Short
Path First (SPF) calculations, etc.) remain unchanged.  However, some
changes have been necessary, either due to changes in protocol
semantics between IPv4 and IPv6, or simply to handle the increased
address size of IPv6.  These modifications will necessitate
incrementing the protocol version from version 2 to version 3.  OSPF
for IPv6 is also referred to as OSPF version 3 (OSPFv3).</p></blockquote>
<blockquote>
<p>Changes between OSPF for IPv4, OSPF Version 2, and OSPF for IPv6 as
described herein include the following.  Addressing semantics have
been removed from OSPF packets and the basic Link State
Advertisements (LSAs).  New LSAs have been created to carry IPv6
addresses and prefixes.  OSPF now runs on a per-link basis rather
than on a per-IP-subnet basis.  Flooding scope for LSAs has been
generalized.  Authentication has been removed from the OSPF protocol
and instead relies on IPv6&rsquo;s Authentication Header and Encapsulating
Security Payload (ESP).</p></blockquote>
<blockquote>
<p>Even with larger IPv6 addresses, most packets in OSPF for IPv6 are
almost as compact as those in OSPF for IPv4.  Most fields and packet-
size limitations present in OSPF for IPv4 have been relaxed.  In
addition, option handling has been made more flexible.</p></blockquote>
<blockquote>
<p>All of OSPF for IPv4&rsquo;s optional capabilities, including demand
circuit support and Not-So-Stubby Areas (NSSAs), are also supported
in OSPF for IPv6.</p></blockquote>
<h2 id="ospfv3-packet-header">OSPFv3 Packet Header<a hidden class="anchor" aria-hidden="true" href="#ospfv3-packet-header">#</a></h2>
<p><img alt="OSPFv3 Packet Header" loading="lazy" src="/my-notes-about-ospf/packet_header_ospfv3.png"></p>
<hr>
<h1 id="multicast-groups">Multicast Groups<a hidden class="anchor" aria-hidden="true" href="#multicast-groups">#</a></h1>
<h2 id="ospfv2-multicast-groups">OSPFv2 Multicast groups<a hidden class="anchor" aria-hidden="true" href="#ospfv2-multicast-groups">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Multicast Group</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>224.0.0.5</td>
          <td>All OSPF Routers</td>
      </tr>
      <tr>
          <td>224.0.0.6</td>
          <td>All DR Routers</td>
      </tr>
  </tbody>
</table>
<h2 id="ospfv3-multicast-groups">OSPFv3 Multicast groups<a hidden class="anchor" aria-hidden="true" href="#ospfv3-multicast-groups">#</a></h2>
<table>
  <thead>
      <tr>
          <th>Multicast Group</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>FF02::5</td>
          <td>OSPFv3 Routers</td>
      </tr>
      <tr>
          <td>FF02::6</td>
          <td>OSPFv3 Designated Routers</td>
      </tr>
  </tbody>
</table>
<hr>
<h1 id="timers">Timers<a hidden class="anchor" aria-hidden="true" href="#timers">#</a></h1>
<table>
  <thead>
      <tr>
          <th>Interval</th>
          <th>Broadcast</th>
          <th>Non-Broadcast</th>
          <th>Point-to-Point</th>
          <th>Point-to-Multipoint</th>
          <th>Point-to-Multipoint Non-Broadcast</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Hello</td>
          <td>10</td>
          <td>30</td>
          <td>10</td>
          <td>30</td>
          <td>30</td>
      </tr>
      <tr>
          <td>Dead</td>
          <td>40</td>
          <td>120</td>
          <td>40</td>
          <td>90</td>
          <td>120</td>
      </tr>
      <tr>
          <td>Wait</td>
          <td></td>
          <td></td>
          <td>40</td>
          <td>90</td>
          <td></td>
      </tr>
      <tr>
          <td>Retransmit</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<hr>
<h1 id="ospfv2-lsa-types">OSPFv2 LSA Types<a hidden class="anchor" aria-hidden="true" href="#ospfv2-lsa-types">#</a></h1>
<h2 id="lsa-type-1--router-lsa">LSA Type 1 – Router LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-1--router-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> Intra-Area</li>
<li><strong>CLI Command:</strong><br>
<code>show ip ospf database router</code></li>
<li><strong>Description:</strong>
<ul>
<li>Each router within an area floods a Type 1 Router LSA to other routers in the same area.</li>
<li>This LSA describes all of the router’s interfaces, neighbor relationships, and metrics.</li>
</ul>
</li>
</ul>
<h2 id="lsa-type-2--network-lsa">LSA Type 2 – Network LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-2--network-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> Intra-Area</li>
<li><strong>CLI Command:</strong><br>
<code>show ip ospf database network</code></li>
<li><strong>Description:</strong>
<ul>
<li>Generated by the <strong>Designated Router (DR)</strong> on multi-access networks (e.g., Ethernet).</li>
<li>Represents the multi-access network and all attached routers as a <strong>pseudonode</strong> (virtual router).</li>
<li>Lists all routers connected to the network segment, including the DR itself.</li>
<li>Like Type 1 LSAs, Type 2 LSAs are flooded only within the originating area.</li>
</ul>
</li>
</ul>
<h2 id="lsa-type-3--network-summary-lsa">LSA Type 3 – Network Summary LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-3--network-summary-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> Inter-Area</li>
<li><strong>CLI Command:</strong><br>
<code>show ip ospf database summary</code></li>
<li><strong>Description:</strong>
<ul>
<li>Originated by <strong>ABRs</strong>.</li>
<li>Advertises destinations <strong>outside</strong> the local area <strong>into</strong> the area.</li>
<li>Used by ABRs to inform internal routers about reachable destinations in other areas.</li>
<li>ABRs also advertise routes from their own areas <strong>into the backbone (Area 0)</strong> using Type 3 LSAs.</li>
<li>Can also be used to advertise <strong>default routes</strong> internal to the OSPF autonomous system.</li>
</ul>
</li>
</ul>
<h2 id="lsa-type-4--asbr-summary-lsa">LSA Type 4 – ASBR Summary LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-4--asbr-summary-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> Inter-Area</li>
<li><strong>CLI Commands:</strong><br>
<code>show ip ospf database asbr-summary</code><br>
<code>show ip ospf border-routers</code></li>
<li><strong>Description:</strong>
<ul>
<li>Also originated by <strong>ABRs</strong>.</li>
<li>Similar to Type 3 LSAs but specifically advertises routes to <strong>ASBRs</strong>.</li>
<li>The destination is always a <strong>host address</strong> representing the ASBR router itself.</li>
</ul>
</li>
</ul>
<h2 id="lsa-type-5--external-lsa">LSA Type 5 – External LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-5--external-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> External Routes (E1/E2)</li>
<li><strong>CLI Commands:</strong><br>
<code>show ip ospf database external</code><br>
<code>show ip ospf border-routers</code></li>
<li><strong>Description:</strong>
<ul>
<li>Originated by <strong>ASBRs</strong>.</li>
<li>Advertises destinations <strong>external</strong> to the OSPF autonomous system (e.g., routes from BGP, static).</li>
<li>Can also advertise <strong>default routes</strong> from outside the OSPF domain.</li>
<li>Flooded throughout the <strong>entire OSPF domain</strong>.</li>
</ul>
</li>
</ul>
<h2 id="lsa-type-7--nssa-external-lsa">LSA Type 7 – NSSA External LSA<a hidden class="anchor" aria-hidden="true" href="#lsa-type-7--nssa-external-lsa">#</a></h2>
<ul>
<li><strong>Route Type:</strong> External Routes (N1/N2)</li>
<li><strong>CLI Commands:</strong><br>
<code>show ip ospf database external</code><br>
<code>show ip ospf border-routers</code></li>
<li><strong>Description:</strong>
<ul>
<li>Originated by <strong>ASBRs within Not-So-Stubby Areas (NSSA)</strong>.</li>
<li>Similar to Type 5 LSAs but scoped only within the <strong>originating NSSA</strong>.</li>
<li>Not flooded beyond the NSSA; may be <strong>translated to Type 5</strong> by the ABR for propagation beyond the NSSA.</li>
</ul>
</li>
</ul>
<hr>
<h1 id="ospf-options">OSPF Options<a hidden class="anchor" aria-hidden="true" href="#ospf-options">#</a></h1>
<h2 id="down-bit">Down Bit<a hidden class="anchor" aria-hidden="true" href="#down-bit">#</a></h2>
<ul>
<li>The down bit helps prevent routing loops between MP-BGP and OSPF when LSA Type 3 are used, but not when External Routes are announced.</li>
<li>With LSA Type 5 and Type 7, there is a new field checked to avoid loops is called the Tag field. When a PE redistributes a route from MP-BGP into OSPF as LSA Type 5 or LSA Type 7, it adds a Tag to the route (tag 3989725929 by default). So if another PE receives an LSA Type 5 or LSA Type 7 with this tag, it doesn’t redistribute it back into MP-BGP.  The default Tag value of 3989725929 can be changed to any other value (redistribute bgp 65001 subnets tag 100).</li>
</ul>
<h2 id="n-bit">N Bit<a hidden class="anchor" aria-hidden="true" href="#n-bit">#</a></h2>
<ul>
<li>This bit is used in hello packets for OSPF NSSA routers. When the N-bit is not supported, the routers won’t become neighbors.</li>
</ul>
<h2 id="p-bit">P Bit<a hidden class="anchor" aria-hidden="true" href="#p-bit">#</a></h2>
<ul>
<li>The P-bit (P stands for propagate) is set in the Options field of an LSA type 7.</li>
<li>P-bit tells the ABR if the LSA type 7 should be translated into a LSA type 5 or not.</li>
<li>P-bit is automatically set by default for all prefixes that are redistributed by the ASBR and are flooded within that area only.</li>
<li>Can be disabled with nssa-only keyword.</li>
<li>The P-bit is not set only when the NSSA ASBR and NSSA ABR are the same router for the area.</li>
<li>This P-bit is automatically set by the NSSA ABR (also the Forwarding Address (FA) is copied from Type 7 LSA).</li>
</ul>
<p><strong>Note:</strong></p>
<ul>
<li>If a router is attached to another AS and is also an NSSA ABR, it may originate a both a Type 5 and a Type 7 LSA for the same network.</li>
<li>The Type 5 LSA will be flooded to the backbone and the Type 7 will be flooded into the NSSA. If this is the case, the P-bit must be reset (P=0) in the Type 7 LSA so the Type 7 LSA isn’t again translated into a Type 5 LSA by another NSSA ABR.</li>
</ul>
<h2 id="routing-bit">Routing Bit<a hidden class="anchor" aria-hidden="true" href="#routing-bit">#</a></h2>
<ul>
<li>The routing bit is not a part of the LSA itself. Routing Bit is an internal maintenance bit used by IOS indicating that the route to the destination advertised by this LSA is valid. So when you see &ldquo;Routing Bit Set on this LSA,&rdquo; it means that the route to this destination is in the routing table.</li>
</ul>
<hr>
<h2 id="demand-circuit">Demand Circuit<a hidden class="anchor" aria-hidden="true" href="#demand-circuit">#</a></h2>
<ul>
<li>Per RFC 1793, Extending OSPF to Support Demand Circuits,  “OSPF Hellos and the refresh of OSPF routing information are suppressed on demand circuits, allowing the underlying data-link connections to be closed when not carrying application traffic.”  This feature allows low-speed and pay-per-use links, such as analog dial and ISDN, to run OSPF without the need for periodic hellos and LSA flooding. Periodic hellos are only suppressed for point-to-point and point-to-multipoint OSPF network types.</li>
<li>This feature is enabled with the interface-level command ip ospf demand-circuit and is negotiated as part of the neighbor adjacency establishment, thus only one OSPF router on the segment requires that the feature be enabled. If routers on the segment do not support it, it will just ignore the option in the HELLO packet, but OSPF neighbors will still be established.</li>
</ul>
<h2 id="flood-reduction">Flood Reduction<a hidden class="anchor" aria-hidden="true" href="#flood-reduction">#</a></h2>
<ul>
<li>Per RFC 2328, OSPF Version 2, “an LSA&rsquo;s LS age is never incremented past the value MaxAge.&quot;, so when the Link State Age reaches MaxAge, &ldquo;the router must attempt to flush the LSA&hellip; by reflooding the MaxAge LSA just as if it was a newly originated LSA&rdquo;.</li>
<li>In Cisco’s IOS implementation of OSPF, the MaxAge value is 3600 seconds, or 60 minutes. To ensure that an LSA is not aged out, which means it will be flushed from the OSPF database, each LSA is reflooded after 30 minutes, regardless of whether the topology is stable or not. This periodic flooding behavior is commonly referred to as the “paranoid update.”</li>
<li>The ip ospf flood-reduction feature stops unnecessary LSA flooding by setting the DoNotAge (DNA) bit in the LSA, removing the requirement for the periodic refresh. This needs to be enabled on links with OSPF neighbors attached, as on the other links, as there are no neighbors, no LSAs are sent anyways.</li>
</ul>
<h2 id="stub-router-feature">Stub Router Feature<a hidden class="anchor" aria-hidden="true" href="#stub-router-feature">#</a></h2>
<ul>
<li>Prevents a router from becoming a transit router (nontransit router).</li>
<li>Nontransit routers only forward packets to and from locally attached subnets.</li>
</ul>
<p>max-metric router-lsa</p>
<ul>
<li>only transit networks
max-metric router-lsa include-stub</li>
<li>transit networks + stub networks (ex: loopback)
max-metric router-lsa on-startup announce-time
max-metric router-lsa on-startup wait-for-bgp</li>
</ul>
<h2 id="ospf-graceful-shutdown">OSPF Graceful Shutdown<a hidden class="anchor" aria-hidden="true" href="#ospf-graceful-shutdown">#</a></h2>
<p>Similar to using the shutdown command on an  interface, there is also a shutdown command for OSPF. This allows you to  gracefully stop the OSPF routing process without removing the  configuration from your router. You can do this globally or on the  interface level.</p>
<p>If you want to do a graceful shutdown globally, you have to use the shutdown command under the OSPF process. This will:</p>
<ul>
<li>Drop all neighbor adjacencies</li>
<li>Flush all LSAs that the router originated by setting the age to 3600 seconds</li>
<li>Send hello packets with the DR/BDR set to 0.0.0.0 and an empty neighbor list. This will trigger other OSPF routers to fall back to init state.</li>
<li>Stop sending/receiving OSPF packets</li>
</ul>
<p>If you shut OSPF on the interface level with the ip ospf shutdown command, it will do this:</p>
<ul>
<li>Drop all neighbor adjacencies on the interface you selected</li>
<li>Flood updated LSAs where all information (prefix, neighbors) from the selected interface is removed</li>
<li>Send hello packets with the DR/BDR set to 0.0.0.0 and an empty neighbor list. This will trigger other OSPF router to fall back to init state</li>
<li>Stop sending/receiving OSPF packets</li>
</ul>
<hr>
<h1 id="ospf-filtering">OSPF Filtering<a hidden class="anchor" aria-hidden="true" href="#ospf-filtering">#</a></h1>
<h2 id="ospf-rib-filtering">OSPF RIB Filtering<a hidden class="anchor" aria-hidden="true" href="#ospf-rib-filtering">#</a></h2>
<ul>
<li>distribute-list with ACL</li>
<li>distribute-list with route-map</li>
<li>Administrative Distance</li>
<li>RIB filtering does not stop the flooding of LSAs within the area</li>
</ul>
<h2 id="inter-area-routes">Inter Area Routes<a hidden class="anchor" aria-hidden="true" href="#inter-area-routes">#</a></h2>
<ul>
<li>area X range 10.0.0.0 not-advertise
<ul>
<li>Only effective when ABR is translating from Type 1 LSA to a Type 3 LSA (learn from INTRA Area and advertise INTER Area)</li>
</ul>
</li>
<li>area X filter-list prefix XXX in
<ul>
<li>prevent routes from being advertised TO the specified area</li>
</ul>
</li>
<li>area X filter-list prefix XXX out
<ul>
<li>prevent routes from being advertised FROM the specified area</li>
</ul>
</li>
</ul>
<h2 id="external-routes-lsa-type-57">External Routes (LSA Type 5/7)<a hidden class="anchor" aria-hidden="true" href="#external-routes-lsa-type-57">#</a></h2>
<p>Effective to filter when going between areas
Has to be applied on the device that is doing the translation into Type 5 LSA</p>
<ul>
<li>summary-address 10.0.0.0 255.255.255.0 not-advertise</li>
<li>summary-address 10.0.0.0 255.255.255.0 nssa-only</li>
</ul>
<hr>
<h1 id="inter-area-ospf-is-distance-vector-ospf-loop-prevention">Inter-Area OSPF is Distance Vector (OSPF Loop Prevention)<a hidden class="anchor" aria-hidden="true" href="#inter-area-ospf-is-distance-vector-ospf-loop-prevention">#</a></h1>
<p>The content below is from an amazing post by <strong>Jeff Doyle</strong>, available on the link below, where Jeff gets into details about OSPF&rsquo;s behavior with Intra-Area deployments.</p>
<blockquote>
<p><strong><em>Source:</em></strong> <a href="https://www.networkworld.com/article/2348778/my-favorite-interview-question.html">https://www.networkworld.com/article/2348778/my-favorite-interview-question.html</a></p></blockquote>
<p><strong>Why does OSPF require all traffic between non-backbone areas to pass through a backbone area (area 0)?</strong></p>
<p>Comparing  three fundamental concepts of link state protocols, concepts that even most OSPF beginners understand, easily derives the answer to the above question.</p>
<p><strong>The first concept:</strong></p>
<p>Every link state router floods information about itself, its links, and its neighbors to every other router. From this flooded information each  router builds an identical link state database. Each router then independently runs a shortest-path-first calculation on its database – a local calculation using distributed information – to derive a shortest-path tree. This tree is a sort of map of the shortest path to every other router.</p>
<p>One of the advantages of link state protocols is that the link state database provides a “view” of the entire network, preventing most routing loops. This is in contrast to distance vector protocols, in which route information is passed hop-by-hop through the network and a calculation is performed at each hop – a distributed calculation using local information. Each router along a route is dependent on the router before it to perform its calculations correctly and then correctly pass along the results. When a router advertises the prefixes it learns to its neighbors it’s basically saying, “I know how to reach these destinations.” And because each distance vector router knows only what its neighbors tell it, and has no “view” of the network beyond the neighbors, the protocol is vulnerable to loops.</p>
<p><strong>The second concept:</strong></p>
<p>When link state domains grow large, the flooding and the resulting size of the link state database becomes a scaling problem. The problem is remedied by breaking the routing domain into areas: That first concept is modified so that flooding occurs only within the boundaries of an area, and the resulting link state database contains only information from the routers in the area. This, in turn, means that each router’s calculated shortest-path tree only describes the path to other routers within the area.</p>
<p><strong>The third concept:</strong></p>
<p>OSPF areas are connected by one or more Area Border Routers (the other main  link state protocol, IS-IS, connects areas somewhat differently) which maintain a separate link state database and calculate a separate shortest-path tree for each of their connected areas. So an ABR by definition is a member of two or more areas. It advertises the prefixes it learns in one area to its other areas by flooding Type 3 LSAs into the areas that basically say, “I know how to reach these destinations.”
Wait a minute – what that last concept described is not link state, it’s distance vector. The routers in an area cannot “see” past the ABR, and  rely on the ABR to correctly tell them what prefixes it can reach. The SPF calculation within an area derives a shortest-path tree that depicts  all prefixes beyond the ABR as leaf subnets connected to the ABR at some specified cost.</p>
<p>And that leads us to the answer to the question:
Because inter-area OSPF is distance vector, it is vulnerable to routing loops. It avoids loops by mandating a loop-free inter-area topology, in which traffic from one area can only reach another area through area 0.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/journey-to-ccie/">
    <span class="title">« Prev</span>
    <br>
    <span>My Journey to CCIE</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/ios-xe-telemetry/">
    <span class="title">Next »</span>
    <br>
    <span>Cisco IOS XE Model-Driven Telemetry</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Guilherme Lyra</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
